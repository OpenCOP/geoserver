<html>
  <wicket:head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript">

var eoc = (function() {

  function removePipes(text) {
    return text.replace(/\|/g, "")
  }

  return {
    addField: function() {
      $('tr.field:last').clone().appendTo('table.fields')
      $('tr.field:last .name').val("")
      $('tr.field:last .name').focus()
    },

    deleteField: function(span) {
      if( $('tr.field').length > 1 ) {
        $(span).parents('tr.field').remove()
      }
    },

    onsubmit: function() {
      $("[name=serialized-fields]").val(
        $('tr.field')
          .map(function(i, tr) {
            return removePipes($(tr).find('input').val())
                 + "|"
                 + removePipes($(tr).find('select :selected').text())})
          .toArray().join("|"))
    }
  }
}())

$(function() {
  var textfield = $('input.text:first')
  if(textfield) textfield.focus().select()
})

    </script>
  </wicket:head>
  <body>
    <wicket:extend>
      <form wicket:id="featureTypeForm" onsubmit="return eoc.onsubmit()">
        <label for="layername">layername</label>
        <input type="text" wicket:id="layername"></input>

        <label for="storesDropDown">namespace</label>
        <select wicket:id="storesDropDown"></select>

        <label for="style">style</label>
        <input type="text" wicket:id="style"></input>

        <input type="hidden" wicket:id="serialized-fields"></input>

        <table class="fields">
          <p>
            <span class="fake-button" onclick="eoc.addField()">+</span>
            Add field
          </p>
          <tr wicket:id="schema" class="field">
            <td><span class="fake-button" onclick="eoc.deleteField(this)">-</span></td>
            <td><input type="text" wicket:id="name" class="name"></input></td>
            <td><select wicket:id="type" class="type"></select></td>
          </tr>
        </table>
        <input type="submit" value="Save Feature Type" />
      </form>
    </wicket:extend>
  </body>
</html>
